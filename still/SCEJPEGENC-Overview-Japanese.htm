<html lang="jp">
<head>
<title>SCEJPEGENC-Overview</title>
<meta http-equiv="Content-Type" content= text/html; charset=Shift_JIS>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="Text/css>
<meta name="Author"Content=" Sony Computer Entertainment Inc.">
</head>
<body bgcolor="#ffffff" text="#000000" >
<a name=TOP></a>
<table WIDTH="100%">
<tr><td>
<h3>PSP&reg; Programmer Tool Runtime Library Release 6.6.0</h3>
</td>
</tr>
</table>
<hr noshade size=6>
<center><h1>
JPEGエンコーダ
</h1></center>
</a>
<!-- sce_hd1 -->

<!-- sce_hd3 -->
<a name="Heading3_1">
<h2>
 1 <!-- hp --><b>ライブラリ概要</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_1_1">
<h3>
<a href="#Heading3_1"> 1. </a>1 
<!-- hp1 --><b>機能の概要と特長</b><br>
</a>
</h3>
<div style="margin-left:50px;">JPEGエンコーダライブラリはRGBA形式の入力データをJPEGデータにエンコードする機能を提供します。エンコード速度を重視しているため、入出力形式は固定としています。<br>具体的には、入力は32ビットRGBA8888形式または、16ビットRGBA5551形式です。出力はYUV420形式のJPEGデータとなります。<br>必要に応じてエンコード品質やヘッダ形式を変更することが可能です。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_2">
<h3>
<a href="#Heading3_1"> 1. </a>2 
<!-- hp1 --><b>特長</b><br>
</a>
</h3>
</ol>
<div style="margin-left:40px;"><ul>
<li> エンコード速度を重視
<li> VFPUを使用できる環境の場合はVFPUによる最適化バージョンを用意
<li> 入力形式は32ビットRGBA8888形式か、16ビットRGBA5551形式のフレームバッファ
<li> 出力形式はYUV420形式のJPEGデータ
<li> 以下の仕様を変更することが可能
</ul></div>
<div style="margin-left:70px;"><ul>
<li> フレームバッファサイズ
<li> 最大画像サイズ
<li> エンコード品質
<li> ヘッダ形式(モーションJPEGまたは通常JPEG)
</ul></div>
</ul>

<!-- sce_hd4 -->
<a name="Heading4_1_3">
<h3>
<a href="#Heading3_1"> 1. </a>3 
<!-- hp1 --><b>関連ファイル</b><br>
</a>
</h3>
<div style="margin-left:50px;">JPEGデコードライブラリを使用するには次のファイルが必要です。<br>スタティックリンクライブラリファイルはVFPUが使用できる環境であればlibscejpegenc_vfpu.a、その他の場合はlibscejpegenc.aを使用してください。<br><br></div>
<div style="margin-left:90px;">
<table border=1>
<tr>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>カテゴリ</b>&nbsp;&nbsp;</td>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>ファイル名</b>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;スタティックリンクライブラリファイル&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;libscejpegenc.a&nbsp;&nbsp;<br>&nbsp;&nbsp;libscejpegenc_vfpu.a&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;ヘッダファイル&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;scejpegenc.h&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<br>

<!-- sce_hd4 -->
<a name="Heading4_1_4">
<h3>
<a href="#Heading3_1"> 1. </a>4 
<!-- hp1 --><b>サンプルプログラム</b><br>
</a>
</h3>

<!-- sce_title -->
<a Name ="HeadingT_1_4_1">
<div style="margin-left:40px;"><h4><b>devkit/sample/jpeg/enc_simple</b><br><br></h4></div></a>

<div style="margin-left:67px;">devkit/sample/graphics/simpleサンプルにJPEGエンコードの使用手順を追加したサンプルです。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_2">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/avi_wrapper</b><br><br></h4></div></a>

<div style="margin-left:67px;">avienc / jpegenc / fmacvideo / u-lawライブラリなどを使用して、AVI (motion JPEG)動画を作成するサンプルソースです。devkit/sample/avi配下の各サンプルはこちらのソース・ヘッダを使用しています。詳しくは各サンプル内のreadmeを参照ください。<br>ソースを確認することで、フレームバッファをMotion JPEGに、PCM波形をu-law圧縮形式などにエンコードして、AVIにまとめて動画にし、フラッシュメディアに保存する流れを把握できます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_3">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/avi_wrap_template</b><br><br></h4></div></a>

<div style="margin-left:67px;">avi_wrapper/配下のソース及びヘッダを使用してタイトルアプリケーションに実装するためにヘッダテンプレートを用意しています。コピーなどして、タイトルアプリケーションの仕様に合わせて変更ください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_4">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_simple</b><br><br></h4></div></a>

<div style="margin-left:67px;">グラフィックスの処理を行っているサンプルプログラムdevkit/sample/graphics/simpleに無音の録画機能を追加したサンプルです。<br>本サンプルでは録画機能についてmain.cのみ改変しています(Makefileも環境に合わせて改変が必要です)。<br>devkit/sample/graphics/simpleと差分を取ることで変更箇所が把握できます。<br>プロモーションビデオ用の素材などをデジタル録画するための参考にしてください。<br>無音のAVIはシステムソフトウェアでは対応していませんのでご注意ください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_5">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_at3mix</b><br><br></h4></div></a>

<div style="margin-left:67px;">サウンドとグラフィックスの処理を行っているサンプルプログラムdevkit/sample/sound/at3mixに録画機能を追加したサンプルです。<br>本サンプルでは録画機能についてmain.cとsoundthread.*のみ改変しています(Makefileも環境に合わせて改変が必要です)。<br>devkit/sample/sound/at3mixと差分を取ることで変更箇所が把握できます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_6">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_p3da_revolve</b><br><br></h4></div></a>

<div style="margin-left:67px;">3Dオーディオの処理を行っているサンプルプログラムdevkit/sample/sound/p3da_revolveに録画機能を追加したサンプルです。本サンプルでは録画機能についてmain.cとsound.*のみ改変しています(Makefileも環境に合わせて改変が必要です)。<br>※ 録画機能とは別にkey.*も改変しています。<br>devkit/sample/sound/p3da_revolveと差分を取ることで変更箇所が把握できます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_7">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_starmix</b><br><br></h4></div></a>

<div style="margin-left:67px;">サウンドとグラフィックスの処理を行っているサンプルプログラムdevkit/sample/sound/starmixに録画機能を追加したサンプルです。<br>本サンプルでは録画機能についてmain.cとat3plus.*のみ改変しています(Makefileも環境に合わせて改変が必要です)。<br>devkit/sample/sound/starmixと差分を取ることで変更箇所が把握できます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_8">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_at3doubleplay</b><br><br></h4></div></a>

<div style="margin-left:67px;">サウンドとグラフィックスの処理を行っているサンプルプログラムdevkit/sample/sound/at3doubleplayに録画機能を追加したサンプルです。<br>本サンプルは応用編です。AVI録画の基本機能について把握するためには別のサンプルを参照いただくことをお奨めします。<br>単純なリプレイ機能にてコントローラの情報を保持し、リプレイ録画として録画します。録画中は別のBGMを再生しています。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_2">
<h2>
 2 <!-- hp --><b>使用手順の概略</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">以下の手順でエンコードを行います。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_1"><h4>
(1)&nbsp;<b>エンコードしたい画像と、エンコード結果を格納するバッファを用意する</b><br></h4>
</a></div>
<div style="margin-left:67px;">入力画像は32ビットRGBA8888または16ビットRGBA5551、ラスタースキャン形式となります。<br>出力バッファは十分に大きく（おおまかですがエンコードしたい画像のピクセル数分のバイト数程度）確保することを推奨します。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_2"><h4>
(2)&nbsp;<b>エンコードに使うワークメモリを確保する</b><br></h4>
</a></div>
<div style="margin-left:67px;"><a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderGetContextSize">sceJpegEncoderGetContextSize</a>()を呼び出すと、必要なワークメモリのサイズが返ってきますので、そのサイズ（バイト数）のメモリを確保してください。メモリの先頭アドレスは16の倍数にしてください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_3"><h4>
(3)&nbsp;<b>エンコーダの初期化を行う</b><br></h4>
</a></div>
<div style="margin-left:67px;">エンコーダの初期化関数<a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderInit">sceJpegEncoderInit</a>()に対して、手順(2)で確保したメモリへのポインタを渡します。この時、フレームバッファの縦横ピクセルサイズと、出力バッファのポインタ、出力バッファのサイズを指定してください。フレームバッファのピクセルサイズは16の倍数にしてください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_4"><h4>
(4)&nbsp;<b>エンコーダ設定を行う</b><br></h4>
</a></div>
<div style="margin-left:67px;">デフォルトでは、フレームバッファはRGBA8888形式とみなして、バッファ内の全てのデータを標準的な品質で圧縮する設定となっています。フレームバッファ形式の変更やバッファの一部だけを圧縮したい場合や、品質を変更する（出力データを小さくしたい、あるいは品質を上げたい）ような場合は、別途設定を行う必要があります。<br>バッファ形式の変更は<a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderSetPixelFormat">sceJpegEncoderSetPixelFormat</a>()、有効領域の設定は、<a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderSetValidRegion">sceJpegEncoderSetValidRegion</a>()、品質の設定は<a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderSetCompressionRatio">sceJpegEncoderSetCompressionRatio</a>()で行えます。<br>また、AVIファイルにまとめることで動画として記録するためには、モーションJPEG形式でヘッダを出力する必要があります。これには、<a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderSetHeaderMode">sceJpegEncoderSetHeaderMode</a>()を使ってください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_5"><h4>
(5)&nbsp;<b>エンコードを行う</b><br></h4>
</a></div>
<div style="margin-left:67px;"><a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderEncode">sceJpegEncoderEncode</a>()を呼び出すと、エンコード処理が行われます。<br>戻り値として出力されたJPEGデータのサイズが返ってきますので、適宜記録するようにしてください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_6"><h4>
(6)&nbsp;<b>終了処理</b><br></h4>
</a></div>
<div style="margin-left:67px;"><a href="../still/SCEJPEGENC-Reference-Japanese.htm#sceJpegEncoderEnd">sceJpegEncoderEnd</a>()を呼び出すことで、終了処理を行います。<br><br></div>
<div style="margin-left:50px;">なお、各関数の呼出しに対して適宜エラーチェックを行ってください。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_3">
<h2>
 3 <!-- hp --><b>注意事項</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_3_1">
<h3>
<a href="#Heading3_3"> 3. </a>1 
<!-- hp1 --><b>エンコード品質について</b><br>
</a>
</h3>
<div style="margin-left:50px;">本APIでエンコードするJPEGデータのエンコード品質を変更することができますが、エンコードしたJPEGデータをAVIにまとめて動画とした時に、品質を上げすぎると機器によってはAVIを正しく再生できない場合があります。エンコード品質については十分に検討するようにしてください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_2">
<h3>
<a href="#Heading3_3"> 3. </a>2 
<!-- hp1 --><b>エンコードしたJPEGデータの扱いについて</b><br>
</a>
</h3>
<div style="margin-left:50px;">本APIでエンコードしたJPEGデータはAVIにまとめて動画として使用することなどを目的としています。ファイルとして扱うような場合は仕様について、各リージョンまでご相談ください。<br><br></div>
<p><p><hr>
<div ALIGN="right">
    &copy;2009 Sony Computer Entertainment Inc.  All Rights Reserved.<br>
    SCE CONFIDENTIAL
</div>
</body>
</html>
