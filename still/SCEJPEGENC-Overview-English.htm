<html lang="en">
<head>
<title>SCEJPEGENC-Overview</title>
<meta http-equiv="Content-Type" content= text/html; charset=iso-8859-1>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="Text/css>
<meta name="Author"Content=" Sony Computer Entertainment Inc.">
</head>
<body bgcolor="#ffffff" text="#000000" >
<a name=TOP></a>
<table WIDTH="100%">
<tr><td>
<h3>PSP&trade; Programmer Tool Runtime Library Release 6.3.0</h3>
</td>
</tr>
</table>
<hr noshade size=6>
<center><h1>
JPEG Encoder Overview
</h1></center>
</a>
<!-- sce_hd1 -->

<!-- sce_hd3 -->
<a name="Heading3_1">
<h2>
 1 <!-- hp --><b>Library Overview</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_1_1">
<h3>
<a href="#Heading3_1"> 1. </a>1 
<!-- hp1 --><b>Function Overview and Features</b><br>
</a>
</h3>
<div style="margin-left:50px;">The JPEG encoder library provides functions for encoding RGBA-formatted input data into JPEG format. Since encoding speed is a priority, predefined input and output formats are used.<br>Specifically, the input format must be either 32-bit RGBA8888 or 16-bit RGBA5551 and the output is YUV420-formatted JPEG data.<br>The encoding quality and header format can be changed as desired.<br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_2">
<h3>
<a href="#Heading3_1"> 1. </a>2 
<!-- hp1 --><b>Features</b><br>
</a>
</h3>
</ol>
<div style="margin-left:40px;"><ul>
<li> Encoding speed is prioritized.
<li> In environments where the VFPU is available, a VFPU-optimized version is provided.
<li> Input is taken from a frame buffer formatted as either 32-bit RGBA8888 or 16-bit RGBA5551.
<li> Output is YUV420-formatted JPEG data.
<li> The following parameters can be changed.
</ul></div>
<div style="margin-left:70px;"><ul>
<li> Frame buffer size
<li> Maximum image size
<li> Encoding quality
<li> Header format (motion JPEG or normal JPEG)
</ul></div>
</ul>

<!-- sce_hd4 -->
<a name="Heading4_1_3">
<h3>
<a href="#Heading3_1"> 1. </a>3 
<!-- hp1 --><b>Related files</b><br>
</a>
</h3>
<div style="margin-left:50px;">The following files are required to use the JPEG encoder library.<br>In environments where the VFPU is available, use libscejpegenc_vfpu.a for the static link library file. Otherwise, use libscejpegenc.a.<br><br></div>
<div style="margin-left:90px;">
<table border=1>
<tr>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>Category</b>&nbsp;&nbsp;</td>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>File Name</b>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;Static link library file&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;libscejpegenc.a&nbsp;&nbsp;<br>&nbsp;&nbsp;libscejpegenc_vfpu.a&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;Header file&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;scejpegenc.h&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<br>

<!-- sce_hd4 -->
<a name="Heading4_1_4">
<h3>
<a href="#Heading3_1"> 1. </a>4 
<!-- hp1 --><b>Sample Programs</b><br>
</a>
</h3>

<!-- sce_title -->
<a Name ="HeadingT_1_4_1">
<div style="margin-left:40px;"><h4><b>devkit/sample/jpeg/enc_simple</b><br><br></h4></div></a>

<div style="margin-left:67px;">This sample adds the usage procedure for JPEG encoding to the devkit/sample/graphics/simple sample.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_2">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/avi_wrapper</b><br><br></h4></div></a>

<div style="margin-left:67px;">This directory contains sample source code that shows how to use libraries such as avienc, jpegenc, fmacvideo, or u-law to create an AVI (motion JPEG) movie. The samples under devkit/sample/avi use the source header found here. For details, refer to the readme in each sample.<br>By studying the source code, you can understand the processing flow involved in creating a movie. This includes encoding the contents of the frame buffer as Motion JPEG, encoding PCM waveform data as u-law compressed data, etc. and then merging the encoded results into an AVI file, and saving it on flash media.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_3">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/avi_wrap_template</b><br><br></h4></div></a>

<div style="margin-left:67px;">This directory contains a header template that you can use for including the source and header located under avi_wrapper in a title application. Copy this template into your title application and change it as necessary according to your title's specifications.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_4">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_simple</b><br><br></h4></div></a>

<div style="margin-left:67px;">This sample adds a silent movie recording feature to the simple graphics sample program devkit/sample/graphics/simple.<br>Only main.c was changed to add the movie recording feature (the Makefile must also be changed accordingly for the environment).<br>By looking at the differences between this sample program and devkit/sample/graphics/simple, you can see where the changes were made.<br>Use this as a reference for recording digital movies of materials for promotional videos.<br>Note that silent AVI is not supported by system software.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_5">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_at3mix</b><br><br></h4></div></a>

<div style="margin-left:67px;">This sample adds a movie recording feature to the sound and graphics sample program devkit/sample/sound/at3mix.<br>Only main.c and soundthread.* were changed to add the movie recording feature (the Makefile also must be changed accordingly for the environment).<br>By looking at the differences between this sample program and devkit/sample/sound/at3mix, you can see where the changes were made.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_6">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_p3da_revolve</b><br><br></h4></div></a>

<div style="margin-left:67px;">This sample adds a movie recording feature to the 3D audio sample program devkit/sample/sound/p3da_revolve.<br>Only main.c and sound.* were changed to add the movie recording feature (the Makefile must also be changed accordingly for the environment).<br>Note: key.* was also changed separately from the movie recording feature.<br>By looking at the differences between this sample program and devkit/sample/sound/p3da_revolve, you can see where the changes were made.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_7">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_starmix</b><br><br></h4></div></a>

<div style="margin-left:67px;">This sample adds a movie recording feature to the sound and graphics sample program devkit/sample/sound/starmix.<br>Only main.c and at3plus.* were changed to add the movie recording feature (the Makefile must also be changed accordingly for the environment).<br>By looking at the differences between this sample program and devkit/sample/sound/starmix, you can see where the changes were made.<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_4_8">
<div style="margin-left:40px;"><h4><b>devkit/sample/avi/rec_at3doubleplay</b><br><br></h4></div></a>

<div style="margin-left:67px;">This sample adds a movie recording feature to the sound and graphics sample program devkit/sample/sound/at3doubleplay.<br>This sample is an applied version. You should refer to a different sample to learn about basic features of AVI movie recording.<br>This sample uses a simple replay function to save controller information and perform movie recording as replay recording. BGM is played separately during movie recording.<br><br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_2">
<h2>
 2 <!-- hp --><b>Overview of the Usage Procedure</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">The following procedure can be used for encoding.<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_1"><h4>
(1)&nbsp;<b>Prepare the image to be encoded and the buffer for storing the encoded result</b><br></h4>
</a></div>
<div style="margin-left:67px;">The input image is in 32-bit RGBA8888 or 16-bit RGBA5551 raster scan format.<br>Allocate a sufficiently large enough output buffer (approximately one byte for each pixel in the image to be encoded).<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_2"><h4>
(2)&nbsp;<b>Allocate work memory to be used for encoding</b><br></h4>
</a></div>
<div style="margin-left:67px;">Call <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderGetContextSize">sceJpegEncoderGetContextSize</a>() to obtain the required work memory size, and allocate memory of that size (number of bytes). Make sure the starting memory address is a multiple of 16.<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_3"><h4>
(3)&nbsp;<b>Initialize the encoder</b><br></h4>
</a></div>
<div style="margin-left:67px;">Pass a pointer to the memory that was allocated in step (2) to the encoder initialization function <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderInit">sceJpegEncoderInit</a>(). At the same time, specify the horizontal and vertical pixel sizes of the frame buffer, a pointer to the output buffer, and the output buffer size. Make sure the pixel sizes of the frame buffer are multiples of 16.<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_4"><h4>
(4)&nbsp;<b>Configure the encoder</b><br></h4>
</a></div>
<div style="margin-left:67px;">By default, the frame buffer is considered to be in RGBA8888 format and is configured so that all data in the buffer is compressed with standard quality. Additional settings must be made separately to change the frame buffer format, compress only part of the buffer, or change the quality (i.e. make the output data smaller or increase the quality).<br><a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderSetPixelFormat">sceJpegEncoderSetPixelFormat</a>() can used to change the buffer format, <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderSetValidRegion">sceJpegEncoderSetValidRegion</a>() can be used to set the valid region, and <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderSetCompressionRatio">sceJpegEncoderSetCompressionRatio</a>() can be used to set the quality.<br>Also, to combine the data in an AVI file to record it as a movie, a header must be output in motion JPEG format. Use <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderSetHeaderMode">sceJpegEncoderSetHeaderMode</a>() to accomplish this.<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_5"><h4>
(5)&nbsp;<b>Encode the data</b><br></h4>
</a></div>
<div style="margin-left:67px;">Call <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderEncode">sceJpegEncoderEncode</a>() to perform encoding.<br>This function returns the size of the JPEG data that was output, so check to make sure it is correct.<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_2_6"><h4>
(6)&nbsp;<b>Termination processing</b><br></h4>
</a></div>
<div style="margin-left:67px;">Call <a href="../still/SCEJPEGENC-Reference-English.htm#sceJpegEncoderEnd">sceJpegEncoderEnd</a>() to perform termination processing.<br><br></div>
<div style="margin-left:50px;">Perform appropriate error checking for each function call.<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_3">
<h2>
 3 <!-- hp --><b>Precautions</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_3_1">
<h3>
<a href="#Heading3_3"> 3. </a>1 
<!-- hp1 --><b>Encoding Quality</b><br>
</a>
</h3>
<div style="margin-left:50px;">You can change the encoding quality of the JPEG data that is generated by these APIs. However, when combining the encoded JPEG data into an AVI file for recording a movie, if the encoding quality is set too high, some devices may not be able to play back the AVI file properly. Therefore, carefully check the encoding quality to make sure it is set properly.<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_2">
<h3>
<a href="#Heading3_3"> 3. </a>2 
<!-- hp1 --><b>Handling of Encoded JPEG Data</b><br>
</a>
</h3>
<div style="margin-left:50px;">JPEG data encoded by these APIs is intended to be combined into an AVI file for recording as a movie. Check with each region for the specifications on handling this data as a file.<br><br></div>
<p><p><hr>
<div ALIGN="right">
    &copy;2009 Sony Computer Entertainment Inc.  All Rights Reserved.<br>
    SCE CONFIDENTIAL
</div>
</body>
</html>
