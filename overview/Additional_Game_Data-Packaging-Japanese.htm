<html lang="jp">
<head>
<title>Additional_Game_Data-Packaging</title>
<meta http-equiv="Content-Type" content= text/html; charset=Shift_JIS>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="Text/css>
<meta name="Author"Content=" Sony Computer Entertainment Inc.">
</head>
<body bgcolor="#ffffff" text="#000000" >
<a name=TOP></a>
<table WIDTH="100%">
<tr><td>
<h3>PSP&reg; Downloadable Game Package</h3>
</td>
</tr>
</table>
<hr noshade size=6>
<center><h1>
PSP&reg;追加ゲームデータ パッケージ作成ガイド
</h1></center>
</a>
<!-- sce_hd1 -->

<!-- sce_hd3 -->
<a name="Heading3_1">
<h2>
 1 <!-- hp --><b>はじめに</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">このドキュメントは、PSP&reg;追加ゲームデータパッケージの作成方法を順を追って説明したものです。PSP&reg;追加ゲームデータパッケージとして配布するデータやプログラムの作成方法、パッケージングに必要なコンテンツ情報などの作成方法、パッケージの作成と動作テスト、そしてマスター提出について説明しています。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_1">
<h3>
<a href="#Heading3_1"> 1. </a>1 
<!-- hp1 --><b>PSP&reg;追加ゲームデータパッケージとは</b><br>
</a>
</h3>
<div style="margin-left:50px;">PSP&reg;追加ゲームデータパッケージとは、追加アイテムや追加キャラクターなど、すでにリリースされているアプリケーションに追加するオプショナルコンテンツをPlayStation&reg;Storeで配信するためのデータ形式です。<br>配信されたPSP&reg;追加ゲームデータは、Memory Stick&trade;上にインストールされ、PSP&reg;システムソフトウェアのゲーム列に追加ゲームデータとして表示されます。インストールされたデータは暗号化され、NPDRMのしくみによって管理されて、ユーザーがデータを改竄できないように、また、アクセス権を持たないユーザーが利用できないように保護されています。<br><br>ユーザーがPlayStation&reg;StoreからPSP&reg;追加ゲームデータパッケージをダウンロードするには、PlayStation&reg;3を用いる方法、PSP&reg;を用いる方法と、PCを用いる方法の3とおりがあります。<br>PlayStation&reg;3を用いてダウンロードする場合、PSP&reg;追加ゲームデータパッケージはいったんPlayStation&reg;3の内蔵ハードディスクドライブにインストールされます。その後、ユーザーがPlayStation&reg;3のシステムソフトウェアを操作して、USB接続されたPSP&reg;のMemory Stick&trade;上にコピーします。<br>PSP&reg;を用いてダウンロードする場合は、システムソフトウェアによって、PSP&reg;追加ゲームデータパッケージがMemory Stick&trade;に展開されます。また、PCを用いてダウンロードする場合は、専用のPCアプリケーションであるMedia Goを使用し、USB接続されたPSP&reg;のMemory Stick&trade;にインストールします。<br>ユーザーがPlayStation&reg;3を用いてダウンロードする場合のために、PSP&reg;追加ゲームデータパッケージにはPlayStation&reg;3用のコンテンツ情報ファイルを含めておく必要があります。PSP&reg;またはPCを用いてのダウンロードでは、パッケージに含まれているこれらPlayStation&reg;3用のコンテンツ情報ファイルは表示されないことになります。<br><br>PSP&reg;追加ゲームデータパッケージとは別に、PlayStation&reg;Storeでアプリケーションを配信するためのデータ形式として、PSP&reg;ダウンローダブルゲームパッケージというものがあります。この詳細については、別ドキュメント「PSP&reg;ダウンローダブルゲーム パッケージ作成ガイド」を参照してください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_2">
<h3>
<a href="#Heading3_1"> 1. </a>2 
<!-- hp1 --><b>タイトルの構成とPSP&reg;追加ゲームデータパッケージ</b><br>
</a>
</h3>
<div style="margin-left:50px;">PSP&reg;追加ゲームデータパッケージは、UMD&reg;またはPSP&reg;ダウンローダブルゲームパッケージで提供するアプリケーション本体と組み合わせてひとつのタイトルを構成することになります。最初に説明したように、アプリケーション本体をUMD&reg;またはPSP&reg;ダウンローダブルゲームパッケージで提供し、追加アイテムなどをPSP&reg;追加ゲームデータパッケージで提供するというのが典型的な組み合わせですが、そのほかにも、無償のデモ版と制限解除パッケージ、隠し機能と制限解除パッケージといった組み合わせ方もできます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_1_2_1">
<div style="margin-left:40px;"><h4><b>複数のPSP&reg;追加ゲームデータパッケージの利用</b><br><br></h4></div></a>

<div style="margin-left:67px;">追加アイテムを何種類も提供するなど、ひとつのタイトルで複数のPSP&reg;追加ゲームデータパッケージを利用できるしくみになっています。<br>複数のPSP&reg;追加ゲームデータパッケージを提供する場合、ユーザーがどのパッケージをどの順番でインストールしてもよいように注意して、各パッケージの内容を決めてください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_3">
<h3>
<a href="#Heading3_1"> 1. </a>3 
<!-- hp1 --><b>作業の流れ</b><br>
</a>
</h3>
<div style="margin-left:50px;">PSP&reg;追加ゲームデータパッケージの作成作業は、おおよそ次の手順で進めます。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_1_3_1"><h4>
(1)&nbsp;<b>追加ゲームデータ本体の作成</b><br></h4>
</a></div>
<div style="margin-left:67px;">プログラムとデータを作成してください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_1_3_2"><h4>
(2)&nbsp;<b>パッケージングに必要なファイルの作成</b><br></h4>
</a></div>
<div style="margin-left:67px;">PSP&reg;用のシステムファイルとコンテンツ情報ファイル、PlayStation&reg;3用のコンテンツ情報ファイル、設定ファイルを作成してください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_1_3_3"><h4>
(3)&nbsp;<b>パッケージングと動作テスト</b><br></h4>
</a></div>
<div style="margin-left:67px;">必要なファイルを所定のディレクトリ構造にまとめてZIP形式でアーカイブし、弊社の提供するシンプルオーサリングサービスを用いて「開発用PSP&reg;追加ゲームデータパッケージ」を作成してください。開発用PSP&reg;追加ゲームデータパッケージをPSP&reg;開発ツールにインストールし、十分に動作テストを行ってください。<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_1_3_4"><h4>
(4)&nbsp;<b>マスター提出とQAテスト</b><br></h4>
</a></div>
<div style="margin-left:67px;">テストの終了した開発用PSP&reg;追加ゲームデータパッケージを弊社に提出してください。弊社でのQAテストの終了後、PlayStation&reg;Storeで公開されます。<br></div>

<!-- sce_hd3 -->
<a name="Heading3_2">
<h2>
 2 <!-- hp --><b>追加ゲームデータ本体の作成</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">この章では、PSP&reg;追加ゲームデータパッケージとして配布するデータの作成について説明します。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_1">
<h3>
<a href="#Heading3_2"> 2. </a>1 
<!-- hp1 --><b>ファイル名とサブディレクトリの規定</b><br>
</a>
</h3>
<div style="margin-left:50px;">PSP&reg;追加ゲームデータパッケージのPSP_DATAディレクトリ以下には、任意のファイルを7階層までの任意のサブディレクトリ構成で収めることができます。ただし、PSP_DATAディレクトリ以下の最大パス名長は、200文字です。ファイル名・サブディレクトリ名は、FAT（Memory Stick&trade;のファイルシステム）の規約に従わなければなりません（正確に言えばPlayStation&reg;3の内蔵ハードディスクドライブのファイルシステムであるCFSの規約にも従わなければなりませんが、FATの規約に従えばCFSの規約にも自動的に従うことになります）。FATの規約の詳細については、「FAT Filesystem For Memory Stick&trade;」の概要ドキュメントを参照してください。<br>また、次にあげる名前（"*" 部分はワイルドカード）はシステム予約ですので、ファイル名・サブディレクトリ名に使用してはいけません。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
EBOOT*.*
PBOOT*.*
*.PBP
*.SFO
ICON*.*
PIC*.*
SND*.*
DOCUMENT.DAT
DOCINFO.EDAT

</font></pre></div>
<div style="margin-left:50px;">また、以下の拡張子（および小文字に変えたもの）を持つファイルは、パッケージ作成時に特別な意味を持ちます。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
*.SELF 
*.SPRX 
*.EDAT
</font></pre></div>

<!-- sce_hd4 -->
<a name="Heading4_2_2">
<h3>
<a href="#Heading3_2"> 2. </a>2 
<!-- hp1 --><b>データファイルの作成</b><br>
</a>
</h3>
<div style="margin-left:50px;">PSP&reg;追加ゲームデータパッケージに格納するデータファイルは、アクセス権が管理される暗号化ファイル(NPDRM EDATA)と、管理されない通常ファイルの2種類があります。<br>通常ファイルは権利保護の対象となりません。有料で配布するパッケージには少なくとも一つのNPDRM EDATAファイルを含め、そのファイルの内容を正しく読み出せるかどうかによってユーザーの権利を確認してください。<br>NPDRM EDATAファイルの拡張子は、".EDAT"にする必要があります（小文字でもかまいません）。拡張子が.EDATでないものは、通常ファイルとして扱われます。<br>NPDRM EDATAファイルはシステムにより暗号化されますが、そのときに独自の鍵（k_licensee）を付加することができます。鍵を付けることによって、他のプログラムから内容を読み取られないように保護することができます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_2_2">
<div style="margin-left:40px;"><h4><b>NPDRM EDATAの確認方法</b><br><br></h4></div></a>

<div style="margin-left:67px;">NPDRM EDATAファイルの内容は保護されていますが、ファイル名は保護されていません。PSP&reg;追加ゲームデータパッケージがMemory Stick&trade;にインストールされた後、ユーザーがコピーやリネームを行う可能性があることに注意してください。対応する権利情報ファイルがあれば､コピーされたりリネームされたNPDRM EDATAファイルに対してもアクセスが成功します。<br>このため、NPDRM EDATAファイルにアクセスできることに加えて、そのファイルの内容を確認する必要があります。各パッケージに固有の内容を持つNPDRM EDATAファイルを収めて、その内容を確認してください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_2_3">
<div style="margin-left:40px;"><h4><b>データファイルへのアクセス</b><br><br></h4></div></a>

<div style="margin-left:67px;">PSP&reg;追加ゲームデータパッケージは、Memory Stick&trade;上の次のディレクトリに格納されます。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
ms0:/PSP/GAME/<i>(ハイフンなし品番)</i>/

例）ms0:/PSP/GAME/SXXX01234/
</font></pre></div>
<div style="margin-left:67px;">パッケージ内のファイルにアクセスするために、この絶対パスをプログラムに埋め込んでおく必要があります。<br>また、NPDRM EDATAの内容を読み出すには、NPDRMライブラリを用いて権利確認を行う必要があります。詳細は「NPDRMライブラリ」ドキュメントを参照してください。<br>なお、NPDRM EDATAファイルへのアクセス自体は特に制限されていません。sceIoOpen()で通常のファイルとしてオープンすることも可能で、その場合は内容が暗号化・圧縮された状態で読み出されます。書込みに対しても保護されていません。データの一部を上書きするとNPDRM EDATAファイルとして破損状態になり、復号できなくなりますので注意してください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_2_4">
<div style="margin-left:40px;"><h4><b>Memory Stick&trade;の挿抜について</b><br><br></h4></div></a>

<div style="margin-left:67px;">アプリケーションの動作中にMemory Stick&trade;を抜くと、そのときオープンしているすべてのNPDRM EDATAファイルがクローズされます。Memory Stick&trade;が挿入されたあとでもう一度NPDRM EDATAファイルにアクセスするには、もう一度オープンして権利確認を行う必要があります。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_2_5">
<div style="margin-left:40px;"><h4><b>プログラムの動作テスト</b><br><br></h4></div></a>

<div style="margin-left:67px;">NPDRMライブラリの関数を使用するには、対象となるデータファイルやプログラムファイルがオーサリング済みであることが必要です。単に拡張子を.EDATとしただけでは、データの読み出しはできません。<br>まずはじめの段階では、通常のモジュールユーティリティの関数を使用してプログラムを作成し、ひととおりデバッグを済ませてください。その後、NPDRMライブラリの関数を使用するようにプログラムを書きなおし、後述の手順に従ってオーサリングを行って開発用PSP&reg;追加ゲームデータパッケージを作成し、それを用いてもう一度動作テストとデバッグを行ってください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_3">
<h3>
<a href="#Heading3_2"> 2. </a>3 
<!-- hp1 --><b>複数のPSP&reg;追加ゲームデータパッケージ</b><br>
</a>
</h3>
<div style="margin-left:50px;">ひとつのタイトルで複数のPSP&reg;追加ゲームデータパッケージを利用することができます。<br>複数のPSP&reg;追加ゲームデータパッケージを利用する場合、ユーザーがどのパッケージをどの順序でインストールしてもアプリケーションが適切に動作するように注意してください。たとえば、パッケージAに含まれているファイルを別のパッケージBが無条件に必要とするつくりになっていると、ユーザーがパッケージBだけをインストールした場合に支障が生じることになります。また、同じタイトルのパッケージはMemory Stick&trade;上の同じディレクトリに格納されるため、同じファイル名で内容の異なるファイルが複数のパッケージに含まれていると、インストールの順序によってファイルの内容が異なることになります。このような不整合が起こらないように調整してください。<br>なお、PSP&reg;用の追加ゲームデータ向けシステムファイルおよびコンテンツ情報ファイルは名前がPARAM.PBPに固定されているため、パッケージをMemory Stick&trade;にインストールするごとに必ず上書きされます。一方、PlayStation&reg;3用のコンテンツ情報は（PlayStation&reg;3のハードディスク上で）上書きされません。<br></div>

<!-- sce_hd3 -->
<a name="Heading3_3">
<h2>
 3 <!-- hp --><b>パッケージングに必要なファイルの作成</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">この章では、PSP&reg;追加ゲームデータパッケージを作成するために必要な、以下のファイルについて説明します。<br></div>
<div style="margin-left:40px;"><ul>
<li> PSP&reg;用システムファイル（PARAM.SFO）
<li> PSP&reg;用コンテンツ情報ファイル（ICON0.PNGほか）
<li> PlayStation&reg;3用コンテンツ情報ファイル（静止画アイコン / 高解像度の説明画像 / 標準解像度の説明画像）
<li> 設定ファイル（NPDRM.CONF）
</ul></div>

<!-- sce_hd4 -->
<a name="Heading4_3_1">
<h3>
<a href="#Heading3_3"> 3. </a>1 
<!-- hp1 --><b>PSP&reg;用システムファイル（PARAM.SFO）</b><br>
</a>
</h3>
<div style="margin-left:50px;">システムファイルPARAM.SFOは、ゲームのタイトル名や視聴年齢制限の値などPSP&reg;システムソフトウェアでの表示のために使用されるパラメータや、品番やディスクの通し番号など内部的に使用されるパラメータが格納されているファイルで、専用ツール「SystemFileEditor」を使って作成します。ゲームマスターディスク用のシステムファイルとは内容が異なり、PSP&reg;追加ゲームデータパッケージ用として作成する必要がありますので注意してください。具体的には、MSGamedata_SystemFile_Config.sfcをコンフィグファイルとして指定し、パラメータを以下のように指定してください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_3_1_6">
<div style="margin-left:40px;"><h4><b>TITLE</b><br><br></h4></div></a>

<div style="margin-left:67px;">タイトル名を設定してください。アプリケーション本体と区別できる必要があります。末尾のNULL文字を含めてUTF8で128bytesまでで、改行はできません。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
例）大草原の戦士 追加データ
</font></pre></div>

<!-- sce_title -->
<a Name ="HeadingT_3_1_7">
<div style="margin-left:40px;"><h4><b>PARENTAL_LEVEL</b><br><br></h4></div></a>

<div style="margin-left:67px;">パレンタルロックレベルを0〜11の数字で設定してください。アプリケーション本体と同じ値でなければなりません。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_3_1_8">
<div style="margin-left:40px;"><h4><b>DISC_ID</b><br><br></h4></div></a>

<div style="margin-left:67px;">アプリケーション本体の品番からハイフンを除いた文字列を設定してください。ただしシリーズものや続編などで他のタイトルのPSP&reg;追加ゲームデータにアクセスしたい場合は、異なる品番を使う必要がありますので、あらかじめ弊社パブリッシャーリレーション部までご相談ください。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
例）ABCD01234
</font></pre></div>

<!-- sce_title -->
<a Name ="HeadingT_3_1_9">
<div style="margin-left:40px;"><h4><b>DISC_VERSION</b><br><br></h4></div></a>

<div style="margin-left:67px;">ディスクバージョンとして、X.XXのフォーマットで任意の番号を設定してください。設定しなくてもかまいません。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
例）1.00
</font></pre></div>

<!-- sce_title -->
<a Name ="HeadingT_3_1_10">
<div style="margin-left:40px;"><h4><b>REGION, BOOTABLE, DRIVER_PATH, PSP_SYSTEM_VER, CATEGORY</b><br><br></h4></div></a>

<div style="margin-left:67px;">これらのパラメータはSystemFileEditorが表示するデフォルト値のまま変更しないでください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_2">
<h3>
<a href="#Heading3_3"> 3. </a>2 
<!-- hp1 --><b>PSP&reg;用コンテンツ情報ファイル</b><br>
</a>
</h3>
<div style="margin-left:50px;">PSP&reg;用コンテンツ情報ファイルは、Memory Stick&trade;にインストールされたPSP&reg;追加ゲームデータをPSP&reg;システムソフトウェアの画面に表示するために使用されるアイコン画像などのファイルです。以下の5つのうち、静止画アイコンファイルは必ず作成してください。他のコンテンツ情報ファイルは、オプションです。<br></div>
<div style="margin-left:40px;"><ul>
<li> 静止画アイコンファイル：ICON0.PNG
<li> 動画アイコンファイル：ICON1.PMF
<li> コンテンツ説明画像ファイル：PIC0.PNG
<li> コンテンツ情報背景画像ファイル：PIC1.PNG
<li> BGMファイル：SND0.AT3
</ul></div>
<div style="margin-left:50px;">各ファイルのフォーマットや作成方法などの詳細に関しては、別ドキュメント「ゲームマスターディスク作成手順」の「コンテンツ情報ファイルの作成」の項目を参照してください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_3_2_11">
<div style="margin-left:40px;"><h4><b>コンテンツ情報のオーバーライド</b><br><br></h4></div></a>

<div style="margin-left:67px;">PSP&reg;ダウンローダブルゲームとPSP&reg;追加ゲームデータパッケージの両方があるときに、どちらのコンテンツ情報を優先して表示するかを、PSP&reg;ダウンローダブルゲームの作成時に選択することができます。<br>通常、PSP&reg;ダウンローダブルゲームに含めるシステムファイルを作成するときには、コンフィグファイルとしてUMDGame_SystemFile_Config.sfcを使用します。この場合、さらにPSP&reg;追加ゲームデータパッケージをインストールしても、PSP&reg;ダウンローダブルゲームに含まれるコンテンツ情報が優先して表示されます。<br>一方、PSP&reg;ダウンローダブルゲームに含めるシステムファイルを作成するときに特別なコンフィグファイルUMDGame_Overridable_Config.sfcを使用すると、コンテンツ情報がオーバーライドされ、PSP&reg;追加ゲームデータパッケージに含まれるコンテンツ情報が優先されるようになります。<br>コンテンツ情報のオーバーライドは、無料のPSP&reg;ダウンローダブルゲーム（デモ版）に有料のPSP&reg;追加ゲームデータパッケージ（制限解除パッケージ）を組み合わせてタイトルを構成する場合に役に立ちます。つまり、PSP&reg;ダウンローダブルゲームには「デモ版」という表示の付いたコンテンツ情報を含めておき、PSP&reg;追加ゲームデータパッケージを購入してインストールすればその表示がなくなる、といったことが可能になります。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_3">
<h3>
<a href="#Heading3_3"> 3. </a>3 
<!-- hp1 --><b>PlayStation&reg;3用コンテンツ情報ファイル</b><br>
</a>
</h3>
<div style="margin-left:50px;">ユーザーがPlayStation&reg;3を使ってPSP&reg;追加ゲームデータパッケージをダウンロードした場合のために、PlayStation&reg;3システムソフトウェアの画面に表示されるコンテンツ情報ファイルが必要です。必要なファイルは以下の3つです。<br></div>
<div style="margin-left:40px;"><ul>
<li> 静止画アイコンファイル：ICON0.PNG
<li> 説明画像ファイル(高解像度)：PIC0.PNG
<li> 説明画像ファイル(標準解像度)：PIC2.PNG
</ul></div>
<div style="margin-left:50px;">また、これらの各言語版（ICON0_00.PNGなど）を作成しておくと、PlayStation&reg;3の多言語切り替えによってユーザーの使う言語に合わせた内容を表示させることができます。<br>各ファイルのフォーマットや作成方法などの詳細に関しては、別ドキュメント「PSP&reg;ダウンローダブルゲーム パッケージ作成ガイド」の「PlayStation&reg;3用静止画アイコンファイル」「PlayStation&reg;3用説明画像ファイル」の項目を参照してください。また、画像内容に規定がありますので、弊社が提供するテンプレートに基づいて作成してください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_4">
<h3>
<a href="#Heading3_3"> 3. </a>4 
<!-- hp1 --><b>設定ファイル</b><br>
</a>
</h3>
<div style="margin-left:50px;">設定ファイルは、PlayStation&reg;Storeでコンテンツを識別するためのコンテントIDなど、PSP&reg;追加ゲームデータパッケージの作成に必要なパラメータを記述したテキストファイルです。形式は次のとおりです。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
Content-ID = <i>IV0002-NPXS00004_00-0000111122223333</i>
K-Licensee = <i>0x0123456789abcdef0123456789abcdef</i>
PackageVersion = <i>01.00</i>

</font></pre></div>
<div style="margin-left:50px;">1行目には、「Content-ID = 」に続けてコンテントID、すなわち弊社から発行されるサービスIDにハイフンと任意のラベル16桁を続けたものを記述してください。コンテントIDの詳細については、「PlayStation&reg;Network 概要」ドキュメントを参照してください。コンテントIDは、パッケージごとに異なっていなければなりません。サービスIDはタイトルごとに発行されますので、アプリケーション本体をPSP&reg;ダウンローダブルゲームパッケージで提供している場合や、同じタイトルで複数のPSP&reg;追加ゲームデータパッケージを作成する場合は、ラベルで区別してください。<br>2行目には、「K-Licensee = 」に続けて暗号鍵k_licenseeの値を、0xで始まる16進文字列として記述してください。k_licenseeは、あるユーザーがアクセス権を持つNPDRM EDATAファイルにそのユーザーが起動したほかのプログラムが勝手にアクセスするのを防止する鍵になります。たとえばLinuxで次のコマンドを実行して得られるような、ユニークな値を記述してください。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>例）head -c 16 /dev/random | xxd -g 16
</font></pre></div>
<div style="margin-left:50px;">3行目には、「PackageVersion = 」に続けてマスターパッケージバージョンを、整数部2桁小数点以下2桁の数字で記述してください。数値は「Technical Requirements Checklist for PSP&trade; (PlayStation&reg;Portable) Software」（TRC）に記載されているマスターバージョン番号の決め方に準拠して決めてください。<br>設定ファイルのファイル名は、NPDRM.CONFとしてください。<br></div>

<!-- sce_hd3 -->
<a name="Heading3_4">
<h2>
 4 <!-- hp --><b>パッケージングと動作テスト</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">この章では、用意したファイルをまとめてPSP&reg;追加ゲームデータパッケージを作成する手順と、それを用いて動作テストを行う手順について説明します。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_4_1">
<h3>
<a href="#Heading3_4"> 4. </a>1 
<!-- hp1 --><b>ZIPアーカイブの作成</b><br>
</a>
</h3>
<div style="margin-left:50px;">準備したファイルを以下に示すディレクトリ構成にまとめてください。<br></div>

<div align=center>
<p>
<img src="gif/Additional_Game_Data-Packaging-Japanese001.gif">
</div>
<br>
<div style="margin-left:50px;"><br></div>

<!-- sce_fignum -->
<div align=center>
<p>
<b>図 1  オーサリング用のディレクトリ構成</b><br>
</div>
<br>
<div style="margin-left:50px;">パッケージのルートディレクトリの直下に、「PSP_DATA」という名前のサブディレクトリを作成して、追加ゲームデータとプログラムを配置します。保護するデータファイルの拡張子を.EDATにすることに注意してください。<br>同様に、「PS3_CONT」という名前のサブディレクトリを作成して、PlayStation&reg;3用コンテンツ情報ファイル群を配置します。同様に、「PSP_CONT」という名前のサブディレクトリを作成して、PSP&reg;用システムファイルおよび、PSP&reg;用コンテンツ情報ファイル群を配置します。最後に、ルートディレクトリの直下にNPDRM.CONFという名前で、設定ファイルを配置してください。<br><br>このようなディレクトリ全体をZIP形式でアーカイブし、"<i>コンテントID</i>.SRC.ZIP"というファイル名を付けてください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_4_1_12">
<div style="margin-left:40px;"><h4><b>Linuxコマンドの実行例</b><br><br></h4></div></a>

        <div style="margin-left:80px;"><pre><font size=3>% zip -ry IV0002-NPXS00004_00-0000111122223333.SRC.ZIP .
</font></pre></div>
<div style="margin-left:67px;">devkit/sample/np/np_drm/authoring_sample/にこのZIPアーカイブのサンプルがありますので、参照してください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_4_2">
<h3>
<a href="#Heading3_4"> 4. </a>2 
<!-- hp1 --><b>オーサリング</b><br>
</a>
</h3>
<div style="margin-left:50px;">弊社が提供するシンプルオーサリングサービスを用いて、作成したZIPアーカイブにオーサリングを行い、PSP&reg;追加ゲームデータパッケージを作成してください。シンプルオーサリングサービスの利用方法の詳細は、「PlayStation&reg;Network SMT シンプルオーサリングサービスユーザガイド」ドキュメントを参照してください。<br>アップロードしたファイルに問題がある場合、下記のエラーコードが通知されます。下記以外のエラーが通知される場合、エラーコードと共に弊社にご連絡ください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_4_2_13">
<div style="margin-left:40px;"><h4><b>追加ゲームデータパッケージ オーサリングエラー一覧</b><br><br></h4></div></a>

<div style="margin-left:90px;">
<table border=1>
<tr>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>コード</b>&nbsp;&nbsp;</td>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>原因／対処方法</b>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;16&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM.CONFが見つかりません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;17&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PARAM.SFOが見つかりません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;18&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PSP&reg;用ICON0.PNGが見つかりません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;19&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PlayStation&reg;3用ICON0.PNGが見つかりません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;20&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PlayStation&reg;3用PIC0.PNGが見つかりません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;21&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PlayStation&reg;3用PIC2.PNGが見つかりません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;22&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PS3_CONT/以下に、不要なファイルが存在しています。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;23&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;不要なファイルが含まれています。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;24&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;大文字小文字の違いのみの名前を持つ複数ファイルが、同一ディレクトリに&nbsp;&nbsp;<br>&nbsp;&nbsp;含まれています。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;25&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PSP_DATA/以下に、含めることのできないファイルが存在しています。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;31&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM.CONFの記述に不足あるいは誤りがあります。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;33&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM.CONFのContent-ID指定が不正です。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;35&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PARAM.SFOの異常を検出しました。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;36&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;PARAM.PBPの生成に失敗しました。&nbsp;&nbsp;<br>&nbsp;&nbsp;PSP_CONT/以下のファイルに問題のある可能性があります。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;37&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;処理対象のZIPファイル名に、NPDRM.CONFで指定されたContent-IDが&nbsp;&nbsp;<br>&nbsp;&nbsp;含まれていません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;39&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM.CONFのK-Licensee指定が不正です。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;40&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM.CONFのPackageVersion指定が不正です。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;41&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM SPRXファイルが含まれていますが、NPDRM.CONFにK-Licensee指定が&nbsp;&nbsp;<br>&nbsp;&nbsp;ありません。&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;42&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;NPDRM SPRXファイルの変換処理に失敗しました。&nbsp;&nbsp;<br>&nbsp;&nbsp;不正なPRXファイルの可能性があります。&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<br>
<br>
<div style="margin-left:50px;">正しくオーサリングが行われると、次の2つのファイルが得られます。<br></div>
<div style="margin-left:40px;"><ul>
<li> <i>コンテントID</i>.ZIP：PSP&reg;開発ツールで動作テストを行うためのZIPパッケージ
<li> <i>コンテントID</i>.PKG：PlayStation&reg;3開発ツールでコンテンツ情報を確認するためのPKGパッケージ
</ul></div>

<!-- sce_hd4 -->
<a name="Heading4_4_3">
<h3>
<a href="#Heading3_4"> 4. </a>3 
<!-- hp1 --><b>開発ツールを用いたテスト</b><br>
</a>
</h3>
<div style="margin-left:50px;">ZIPパッケージをMemory Stick&trade;のルートディレクトリに展開して、そのMemory Stick&trade;をPSP&reg;開発ツールにセットしてください。<br>するとPSP&reg;システムソフトウェアのゲーム列に追加ゲームデータが表示されますので、意図したように表示されることを確かめてください。また、PSP&reg;システムソフトウェアのコンテンツ情報チェック機能を用いて、PSP&reg;用コンテンツ情報が適切であることを確認してください（あらかじめPSP&reg;システムソフトウェアを適切なバージョンにアップデートしておく必要があります）。このとき、通常のコンテンツ情報チェック機能の結果に加えて、Warning PARAM.SFO - BOOTABLE: 0(0x0)が表示されることを確認してください。これは、MSGamedata_SystemFile_Config.sfcを使用したことを示すものです。さらに、ダウンローダブルゲームに含まれるコンテンツ情報のオーバーライドを行う場合には、ダウンローダブルゲームにもコンテンツ情報チェック機能を実行し、Warning PARAM.SFO - ATTRIBUTE: 1(0x1)が表示されることを確認してください。<br>また、追加ゲームデータにアクセスするプログラム・追加ゲームデータに含まれるプログラムの動作テストとデバッグを行ってください。ユーザーがアクセス権を持たないときの挙動を確かめるために、Memory Stick&trade;の/LICENSEフォルダにある"<i>コンテントID</i>.RIF"ファイルを削除した状態でプログラムを動作させるテストを必ず行ってください。また、オーサリングする前よりもいくらか負荷が大きくなりますので注意してください。<br><br>PKGパッケージはそのままMemory Stick&trade;、USBマスストレージ、任意の光ディスクのルートディレクトリに保存してください。そのストレージメディア・デバイスをPlayStation&reg;3開発ツールにセットし、システムソフトウェアのゲーム列にある"Install Package Files"という項目を選択してインストールし、システムソフトウェアの画面にPlayStation&reg;3用コンテンツ情報が正しく表示されることを確認してください。また、PSP&reg;開発ツールをPlayStation&reg;3開発ツールにUSB接続し、インストールしたコンテンツを選択することで、PlayStation&reg;3からPSP&reg;にコピーするときの動作を確かめることができます。その際は、PlayStation&reg;Networkにサインインの上、操作を行ってください。<br>なお、PlayStation&reg;3開発ツールをお持ちでない場合は、弊社パブリッシャーリレーション部へご確認ください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_4_4">
<h3>
<a href="#Heading3_4"> 4. </a>4 
<!-- hp1 --><b>パッケージの検査</b><br>
</a>
</h3>
<div style="margin-left:50px;">シンプルオーサリングサービスから得られたPKGパッケージについて、make_package_npdrmコマンドを用いて、正当性の検査をすることができます。<br>正当性の検査をするには、--checkオプションを使用してください。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
例） % make_package_npdrm  --check  IV0002-NPXS00004_00-0000111122223333.pkg

</font></pre></div>
<div style="margin-left:50px;">また、--listオプションを使用することで、パッケージに含まれるファイルを表示することができます。<br></div>
        <div style="margin-left:80px;"><pre><font size=3>
例） % make_package_npdrm  --list  IV0002-NPXS00004_00-0000111122223333.pkg
</font></pre></div>
<div style="margin-left:50px;"><br></div>

<!-- sce_hd3 -->
<a name="Heading3_5">
<h2>
 5 <!-- hp --><b>マスター提出とQAテスト</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_5_1">
<h3>
<a href="#Heading3_5"> 5. </a>1 
<!-- hp1 --><b>マスター提出</b><br>
</a>
</h3>
<div style="margin-left:50px;">テストを終了したら、PKGパッケージのみを弊社に提出してください。チェック済みの「Technical Requirements Checklist for PSP&trade; (PlayStation&reg;Portable) Software」（TRC）そのほかの書類も合わせて提出してください。<br>なおこのとき、PKGパッケージのファイル名が作成したときのまま変更されていないことを確認してください。PKGパッケージのファイル名にはコンテントIDが含まれていて、変更した場合の動作は保証されません。<br>弊社でのQAテストが完了したら、PSP&reg;追加ゲームデータパッケージは、エンドユーザー向けの公開サーバーへ移されて公開されます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_5_1_14">
<div style="margin-left:40px;"><h4><b>特別なQAテスト</b><br><br></h4></div></a>

<div style="margin-left:67px;">いくつかのテスト項目については、特別な工程でQAテストを行います。次のテストを必要とする場合は、あらかじめ弊社パブリッシャーリレーション部にご相談ください。<br></div>
</ul>
<div style="margin-left:70px;"><ul>
<li> PSP&reg;本体のモデル間の互換性テスト
<li> 外部ディスプレイへの出力テスト
<li> 周辺機器を使用してのテスト
</ul></div>

<!-- sce_hd3 -->
<a name="Heading3_6">
<h2>
 6 <!-- hp --><b>参考情報</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_6_1">
<h3>
<a href="#Heading3_6"> 6. </a>1 
<!-- hp1 --><b>Memory Stick&trade;上でのディレクトリ構成</b><br>
</a>
</h3>
<div style="margin-left:50px;">Memory Stick&trade;にPSP&reg;追加ゲームデータパッケージがインストールされたときのディレクトリ構成の例を示します。<br></div>

<div align=center>
<p>
<img src="gif/Additional_Game_Data-Packaging-Japanese002.gif">
</div>
<br>
<div style="margin-left:50px;"><br></div>

<!-- sce_fignum -->
<div align=center>
<p>
<b>図 2  PSP&reg;上でのディレクトリ構成の例</b><br>
</div>
<br>
<div style="margin-left:50px;">追加ゲームデータディレクトリの名前は、PARAM.SFOで指定された品番に基づいて決められますので、コンテントIDに含まれる品番とは別になる場合があります。<br>なお、権利情報ファイルは隠しファイルとなっているため、PCでMemory Stick&trade;の内容を見た場合は存在しないように見えることがあります。<br><br></div>
<p><p><hr>
<div ALIGN="right">
    &copy;2010 Sony Computer Entertainment Inc.  All Rights Reserved.<br>
    SCE CONFIDENTIAL
</div>
</body>
</html>
