<html lang="jp">
<head>
<title>Utility_Gamedata_Install-Overview</title>
<meta http-equiv="Content-Type" content= text/html; charset=Shift_JIS>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="Text/css>
<meta name="Author"Content=" Sony Computer Entertainment Inc.">
</head>
<body bgcolor="#ffffff" text="#000000" >
<a name=TOP></a>
<table WIDTH="100%">
<tr><td>
<h3>PSP&reg; Programmer Tool Runtime Library Release 6.6.0</h3>
</td>
</tr>
</table>
<hr noshade size=6>
<center><h1>
ゲームデータインストールユーティリティ
</h1></center>
</a>
<!-- sce_hd1 -->

<!-- sce_hd3 -->
<a name="Heading3_1">
<h2>
 1 <!-- hp --><b>ユーティリティについて</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">ユーティリティの概要などについては、「ユーティリティサービス」概要ドキュメントを参照してください。<br><br>ゲームデータインストールユーティリティは、UMD&reg;の特定の場所にあるデータを<br>Memory Stick&trade;の/PSP/SAVEDATA/(savedata_dir)以下にコピーする機能です。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_2">
<h2>
 2 <!-- hp --><b>インストール元のデータ構造</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_2_1">
<h3>
<a href="#Heading3_2"> 2. </a>1 
<!-- hp1 --><b>ディレクトリ/ファイル構成</b><br>
</a>
</h3>
<div style="margin-left:50px;">UMD&reg;上のディレクトリ/ファイル構成です。<br></div>

<div style="margin-left:67px;">
<p>
<img src="gif/Utility_Gamedata_Install-Overview-Japanese001.gif">
</div>
<div style="margin-left:50px;"><br>※上記構成に含まれない、ファイルやディレクトリの作成は禁止いたします。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_2">
<h3>
<a href="#Heading3_2"> 2. </a>2 
<!-- hp1 --><b>INSDIR</b><br>
</a>
</h3>
<div style="margin-left:50px;">ゲームデータインストールユーティリティが、インストールする元データファイルを格納してあるディレクトリです。コンテンツ情報ファイル、ゲームデータ合わせて1024ファイルを置くことが可能です。INSDIR以下にディレクトリを作成してはいけません。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_3">
<h3>
<a href="#Heading3_2"> 2. </a>3 
<!-- hp1 --><b>コンテンツ情報ファイル</b><br>
</a>
</h3>

<!-- sce_title -->
<a Name ="HeadingT_2_3_1">
<div style="margin-left:40px;"><h4><b>コンテンツ情報ファイルとは？</b><br><br></h4></div></a>

<div style="margin-left:67px;">インストールデータの内容を代表して表現する画像や映像、BGMをコンテンツ情報と呼びます。PSP&reg;システムソフトウェアのセーブデータ管理でのリスト表示に使用されます。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_3_2">
<div style="margin-left:40px;"><h4><b>ファイル構成</b><br><br></h4></div></a>

<div style="margin-left:67px;">複数のファイルで構成されます。<br></div>
</ol>
<div style="margin-left:70px;"><ul>
<li> 静止画アイコン：ICON0.PNG
<li> 動画アイコン：ICON1.PMF
<li> コンテンツ情報背景画像：PIC1.PNG
<li> BGM：SND0.AT3
</ul></div>

<!-- sce_title -->
<a Name ="HeadingT_2_3_3">
<div style="margin-left:40px;"><h4><b>静止画アイコン</b><br><br></h4></div></a>

<div style="margin-left:67px;">コンテンツにフォーカスが当たっていない場合や、動画アイコンの読み込み時、動画アイコンが設定されない場合の代替アイコンとして表示されます。<br>PSP&reg;システムソフトウェアでは再生されますが、ユーティリティでは表示されません。<br>必須のファイルとなります。必ず作成してください。<br></div>
<div style="margin-left:70px;"><ul>
<li> 画サイズ：144×80ピクセル
<li> 画像フォーマット：PNG(24bit)
<li> ファイル名：ICON0.PNG
<li> 作成ツール：市販のツールなどを使用します。
</ul></div>

<!-- sce_title -->
<a Name ="HeadingT_2_3_4">
<div style="margin-left:40px;"><h4><b>動画アイコン</b><br><br></h4></div></a>

<div style="margin-left:67px;">動画をアイコンとして表示できます。音声付きにすることができます。<br>再生が終了すると最初から再生が始まりますが、音声は途切れてしまいます。音声を途切れなくループさせる場合はBGMを使用してください。ただし、BGMは動画アイコンに同期しません。<br>音声付き動画であっても、BGMがある場合は、音声はBGMのみ再生されます。<br>オプション扱いなので、必要ない場合は省略することができます。<br>PSP&reg;システムソフトウェアでは再生されますが、ユーティリティでは表示/再生されません。<br></div>
<div style="margin-left:70px;"><ul>
<li> 画サイズ：144×80ピクセル
<li> 映像<br>フォーマット：AVCのみでエンコードされたIDR-Picture, P-Pictureで構成<br>　　　　　　　(Main Profile Level2.1(最大ビットレート4.8Mbps)) ※ゲーム用と同様<br>フレームレート：29.97fps progressive
<li> 音声<br>フォーマット：ATRAC3plus&trade;<br>サンプリング周波数：44.1kHz<br>チャンネル：2 channel stereo
<li> 多重化フォーマット：PSMF
<li> ファイルサイズ：BGMファイルと合わせて最大500キロバイト
<li> ファイル名：ICON1.PMF
<li> 作成ツール：弊社提供のUMD&reg; Stream Composer（for Game Movie）およびPSMF Composerをご使用ください。
</ul></div>

<!-- sce_title -->
<a Name ="HeadingT_2_3_5">
<div style="margin-left:40px;"><h4><b>コンテンツ情報背景</b><br><br></h4></div></a>

<div style="margin-left:67px;">背景となる画像です。<br>オプション扱いなので、必要ない場合は省略することができます。<br>PSP&reg;システムソフトウェアでは表示されますが、ユーティリティでは表示されません。<br></div>
<div style="margin-left:70px;"><ul>
<li> 画サイズ：480×272ピクセル
<li> 画像フォーマット：PNG (24bit)
<li> ファイル名：PIC1.PNG
<li> 作成ツール：市販のツールなどを使用します。
</ul></div>

<!-- sce_title -->
<a Name ="HeadingT_2_3_6">
<div style="margin-left:40px;"><h4><b>BGM</b><br><br></h4></div></a>

<div style="margin-left:67px;">音声です。ループ範囲を指定されている場合、途切れなくループ再生することができます。<br>オプション扱いなので、必要ない場合は省略することができます。<br>PSP&reg;システムソフトウェアでは再生されますが、ユーティリティでは再生されません。<br></div>
<div style="margin-left:70px;"><ul>
<li> 音声フォーマット：<br>フォーマット：ATRAC3plus&trade;<br>サンプリング周波数：44.1kHz<br>チャンネル：2 channel stereo
<li> ファイルサイズ：動画アイコンファイルと合わせて最大500キロバイト
<li> ファイル名：SND0.AT3
<li> 作成ツール：弊社提供のat3toolをご使用ください。
</ul></div>

<!-- sce_hd4 -->
<a name="Heading4_2_4">
<h3>
<a href="#Heading3_2"> 2. </a>4 
<!-- hp1 --><b>データファイルgamedata_file…</b><br>
</a>
</h3>

<!-- sce_title -->
<a Name ="HeadingT_2_4_7">
<div style="margin-left:40px;"><h4><b>ファイル名の制限</b><br><br></h4></div></a>

<div style="margin-left:67px;">データファイルの名前には制限があります。<br></div>
<div style="margin-left:70px;"><ul>
<li> 長さ：8.3形式
<li> 使用可能文字：A〜Z 0〜9
</ul></div>
<div style="margin-left:67px;">また、以下の名前はシステムで予約されますのでgamedata_fileの名前に使用しないでください。<br></div>
<div style="margin-left:70px;"><ul>
<li> *.SFO
<li> ICON*.* (ICON0.PNG, ICON1.PMFを除く)
<li> PIC*.* (PIC1.PNGを除く)
<li> SND*.* (SND0.AT3を除く)
</ul></div>
<div style="margin-left:67px;">*は任意の長さの任意の文字を意味します。<br>ユーティリティはUMD&reg;をチェックする際にファイル名をチェックし、不正な名前の場合はエラーを返します。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_4_8">
<div style="margin-left:40px;"><h4><b>ファイルの暗号化</b><br><br></h4></div></a>

<div style="margin-left:67px;">ゲームデータのフォーマットは、ミドルウェアによるアーカイブ形式や、タイトルの独自フォーマットが許されますが、暗号化と電子署名による改竄検出は必須です。<br>ファイルを書き換えられたり、ファイル名を入れ替えられたりしたときに、そのまま使用して誤動作しないように作成してください。<br><br>弊社提供の暗号ファイルフォーマットとして、iofilemgr_dnas形式の暗号ファイルが使用できます。<br>データの作り方は、「iofilemgr_dnas形式ゲームデータオーサリングガイド」ドキュメントを参照してください。<br>また、アクセス方法は「iofilemgr_dnas形式ゲームデータ用API」ドキュメントを参照してください。<br></div>

<!-- sce_title -->
<a Name ="HeadingT_2_4_9">
<div style="margin-left:40px;"><h4><b>その他 ... INSDIRに入れてはいけないファイル</b><br><br></h4></div></a>


<!-- sce_hd6 -->
<a name="Heading6_2_4_1">
<div style="margin-left:63px;"><h4><b>PARAM.SFO</b><br><br></h4></a></div>
<div style="margin-left:80px;">こちらはゲームデータインストールユーティリティに渡されたデータから自動生成されます。<br></div>

<!-- sce_hd6 -->
<a name="Heading6_2_4_2">
<div style="margin-left:63px;"><h4><b>プログラムファイル</b><br><br></h4></a></div>
<div style="margin-left:80px;">ゲームデータとしてMemory Stick&trade;にインストールできるのは、BGMやテクスチャ画像などのデータファイルだけで、プログラムファイル（スクリプトを除く）を置くことは禁止されています。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_3">
<h2>
 3 <!-- hp --><b>タイプ</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">ゲームデータインストールユーティリティは、用途別に画面表示なし、画面表示ありのタイプがあります。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_1">
<h3>
<a href="#Heading3_3"> 3. </a>1 
<!-- hp1 --><b>画面表示なし</b><br>
</a>
</h3>
<div style="margin-left:50px;">このタイプが設定されてゲームデータインストールユーティリティを起動した場合、画面表示を一切行いません。<br>プログレスバー、残り時間等の情報は、ユーティリティに渡す構造体のメンバ変数を参照して取得し、ゲームが進捗を画面表示する必要があります。<br><br><a href="../utility/Utility_Gamedata_Install-Reference-Japanese.htm#sceUtilityGamedataInstallUpdate">sceUtilityGamedataInstallUpdate</a>()関数の呼び出しとゲームプログラム側の描画の排他処理に関しては、「ユーティリティサービス」概要ドキュメントの「sceUtility*Update()関数の呼び出しとゲームプログラム側の描画処理の排他について」を参照してください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_2">
<h3>
<a href="#Heading3_3"> 3. </a>2 
<!-- hp1 --><b>画面表示あり</b><br>
</a>
</h3>
<div style="margin-left:50px;">このタイプが設定されてゲームデータインストールユーティリティを起動した場合、ゲームデータインストールユーティリティがユーザに対してインストールの確認、インストール中のプログレスバー、インストール完了、エラーダイアログの表示を請け負います。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_4">
<h2>
 4 <!-- hp --><b>エラーダイアログの画面表示</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">画面表示を伴わないタイプで返されるエラーについて、メッセージダイアログユーティリティを利用してエラーダイアログを画面表示することができます。<br>エラー値を渡すだけで、画面文言も自動的に出力されます。文言を別の表記にすることも可能です。<br>（メッセージダイアログユーティリティのオプション、エラーダイアログ画面操作などについては「ユーティリティサービス」概要ドキュメントを参照してください。）<br><br>画面表示を伴うタイプについては、エラーダイアログを自動的に出力しますので、上記対応の必要はありません。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_5">
<h2>
 5 <!-- hp --><b>関連ファイル</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">ゲームデータインストールユーティリティを使用するために必要なファイルは次の通りです。<br><br></div>
<div style="margin-left:90px;">
<table border=1>
<tr>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>カテゴリ</b>&nbsp;&nbsp;</td>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>ファイル名</b>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;ヘッダファイル&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;utility_gamedata_install.h&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;スタブライブラリファイル&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;utility_stub.a&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<br>
<br>

<!-- sce_hd3 -->
<a name="Heading3_6">
<h2>
 6 <!-- hp --><b>appendix：ゲームデータのサイズ表記について</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_6_1">
<h3>
<a href="#Heading3_6"> 6. </a>1 
<!-- hp1 --><b>ゲーム中で表示するサイズ（必要な場合）</b><br>
</a>
</h3>
<div style="margin-left:50px;">基本的にクラスタサイズ32KBでのサイズを表示して構いません。<br>Memory Stick&trade;が差されている場合はそのクラスタサイズで正確に計算されたサイズを表示し、差されていない場合はクラスタサイズ32KBでのサイズを表示することを推奨します。<br>これらのサイズは、Memory Stick&trade;を差さずにゲームデータインストールユーティリティを起動した際に、<a href="../utility/Utility_Gamedata_Install-Reference-Japanese.htm#SceUtilityGamedataInstallParam">SceUtilityGamedataInstallParam</a>構造体の<i>needSize</i>(<i>needSizeStr</i>)メンバ変数の戻り値をお使いください。<br></div>

<!-- sce_hd4 -->
<a name="Heading4_6_2">
<h3>
<a href="#Heading3_6"> 6. </a>2 
<!-- hp1 --><b>商品パッケージに記載するサイズ</b><br>
</a>
</h3>
<div style="margin-left:50px;">クラスタサイズは32KBと仮定してインストールサイズを求め、それをパッケージでもお使いください。切りのいい数字にするために、多めに表示することも可能です。<br></div>
<div style="margin-left:67px;">例：544キロバイト&rarr;550キロバイト<br></div>
<div style="margin-left:50px;">また、実際にクラスタサイズ32KBのMemory Stick&trade;（256MB以上のMemory Stick&trade;をPSP&reg;システムソフトウェアでフォーマットすれば作成できます）へインストールデータを保存し、PSP&reg;システムソフトウェアのセーブデータ管理で表示されるセーブデータサイズを参照することでも取得可能です。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_7">
<h2>
 7 <!-- hp --><b>appendix：Memory Stick&trade;の空き容量表示について</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">PSP&reg;システムソフトウェアでは、Memory Stick&trade;の実際の未使用クラスタ数から2クラスタ分を差し引いた値で空き容量計算し、表示しています。<br>この2クラスタは、システムで必要なディレクトリを作成したり、ゲームデータインストールによって、その親ディレクトリが大きくなったりするのを想定し、そのような場合でも正しくインストールされるための予備、マージンとして使われます。<br>異なるシステム上で空き容量を取得した場合との差異にはご注意ください。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_8">
<h2>
 8 <!-- hp --><b>appendix：インストールデータに関して</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">ゲームデータインストールユーティリティに対応したゲームでも、UMD&reg;単体で問題なくゲームが進行できる作りになっている必要があります。<br>また、Memory Stick&trade;にインストールデータがあったとしてもそのデータが正しいものであるかどうかのチェックはゲーム側で必要です。<br><br>ゲームデータインストールでインストールするゲームデータの容量は1GB以下としてください。<br>この制限より大きい容量のゲームデータをインストールする場合は、事前に弊社パブリッシャーリレーション部までご相談ください。<br><br>インストールされたゲームデータを読み込んだ際、エラーが発生した場合は、無限リトライせずに、該当するデータをUMD&reg;から読み込むようにしてください。<br><br>インストールされたゲームデータとUMD&reg;に対して同時にアクセスをしないつくりにしてください。まずは、インストールされたゲームデータに対してアクセスを行い、エラーが発生した場合にUMD&reg;にアクセスするようにして、同時アクセスが発生しないようにしてください。<br><br>ゲームデータインストールユーティリティは、インストールデータを/PSP/SAVEDATA/(savedata_dir)以下にインストールされます。PSP&reg;システムソフトウェアのセーブデータ管理から削除、もしくは、ゲーム内でセーブデータユーティリティの削除タイプで削除することが可能です。<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_9">
<h2>
 9 <!-- hp --><b>appendix：このユーティリティを起動する条件</b>
<hr noshade>
</h2>

<div style="margin-left:50px;">ゲームデータインストールユーティリティは、Memory Stick&trade;に指定されたディレクトリ名が存在した場合、削除してからインストールを開始します。<br>その為、Memory Stick&trade;にインストールデータがない場合、Memory Stick&trade;のインストールデータが壊れている場合にゲームデータインストールユーティリティを起動してください。<br></div>

<!-- sce_hd3 -->
<a name="Heading3_10">
<h2>
 10 <!-- hp --><b>appendix：インストールデータ場所</b>
<hr noshade>
</h2>

<div style="margin-left:90px;">
<table border=1>
<tr>
<td bgcolor="#cccccc">&nbsp;<b>起動元</b>&nbsp;</td>
<td bgcolor="#cccccc">&nbsp;<b>インストール元</b>&nbsp;</td>
<td bgcolor="#cccccc">&nbsp;<b>インストール先</b>&nbsp;</td>
</tr>
<tr>
<td valign="top">&nbsp;デバッガ&nbsp;</td>
<td valign="top">&nbsp;host0&nbsp;</td>
<td valign="top">&nbsp;ms0&nbsp;</td>
</tr>
<tr>
<td valign="top">&nbsp;UMD&reg;&nbsp;</td>
<td valign="top">&nbsp;disc0&nbsp;</td>
<td valign="top">&nbsp;ms0&nbsp;</td>
</tr>
<tr>
<td valign="top">&nbsp;Memory&nbsp;Stick&trade;&nbsp;</td>
<td valign="top">&nbsp;ms0&nbsp;</td>
<td valign="top">&nbsp;ms0&nbsp;</td>
</tr></table>
</div>
<br>
<br>
<div style="margin-left:50px;">Runtime Library 6.20までは、デバッガ経由で起動した場合、ゲームデータインストールユーティリティはUMD&reg;にあるデータを参照していました。<br>Runtime Library 6.30からは、host0:PSP_GAME/INSDIRを参照します。<br><br></div>
<p><p><hr>
<div ALIGN="right">
    &copy;2010 Sony Computer Entertainment Inc.  All Rights Reserved.<br>
    SCE CONFIDENTIAL
</div>
</body>
</html>
