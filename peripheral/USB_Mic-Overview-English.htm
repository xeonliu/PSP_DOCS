<html lang="en">
<head>
<title>USB_Mic-Overview</title>
<meta http-equiv="Content-Type" content= text/html; charset=iso-8859-1>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="Text/css>
<meta name="Author"Content=" Sony Computer Entertainment Inc.">
</head>
<body bgcolor="#ffffff" text="#000000" >
<a name=TOP></a>
<table WIDTH="100%">
<tr><td>
<h3>PSP&trade; Programmer Tool Runtime Library Release 6.3.0</h3>
</td>
</tr>
</table>
<hr noshade size=6>
<center><h1>
USB Mic Overview
</h1></center>
</a>
<!-- sce_hd1 -->

<!-- sce_hd3 -->
<a name="Heading3_1">
<h2>
 1 <!-- hp --><b>Library Overview</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_1_1">
<h3>
<a href="#Heading3_1"> 1. </a>1 
<!-- hp1 --><b>Overview</b><br>
</a>
</h3>
<div style="margin-left:50px;">The USB mic library is used for capturing PCM data from a Microphone or a camera (with mic function) over the USB port. The Microphone is one of the exclusive USB accessories for the PSP&trade;.<br><br>The interface for controlling mic input has the same specifications as the audio input interface provided by the audio driver.<br><br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_2">
<h3>
<a href="#Heading3_1"> 1. </a>2 
<!-- hp1 --><b>Library Configuration</b><br>
</a>
</h3>
<div style="margin-left:50px;">The USB mic library consists of the following three modules.<br></div>
</ol>
<div style="margin-left:40px;"><ul>
<li> USB bus driver (resident module)<br>Base USB driver for PSP&trade;
<li> USB accessory base driver<br>Performs operations that are common to USB accessories
<li> USB mic driver<br>Provides an interface for controlling mic input
</ul></div>
<div style="margin-left:50px;"><br>For details on the USB bus driver, refer to the &quot;USB_Driver-Overview&quot; or &quot;USB_Driver-Reference&quot;. <br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_3">
<h3>
<a href="#Heading3_1"> 1. </a>3 
<!-- hp1 --><b>Main Functions of the USB Mic Library</b><br>
</a>
</h3>
<div style="margin-left:40px;"><ul>
<li> The data format that can be obtained is 16-bit PCM monaural, and the sampling frequency can be either 44100[Hz], 22050 [Hz], or 11025 [Hz].
<li> The input gain can be adjusted manually.
<li> The input gain can be adjusted by an auto level control (ALC).
<li> A built-in noise gate function can be used with ALC.
<li> The time over which the gain changes when ALC is active can be set.
</ul></div>
<div style="margin-left:50px;"><br></div>

<!-- sce_hd4 -->
<a name="Heading4_1_4">
<h3>
<a href="#Heading3_1"> 1. </a>4 
<!-- hp1 --><b>Related Files</b><br>
</a>
</h3>
<div style="margin-left:50px;">The following files are required to use the USB mic library.<br><br></div>
<div style="margin-left:90px;">
<table border=1>
<tr>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>Category</b>&nbsp;&nbsp;</td>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>Filename</b>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;Header file&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;usb.h&nbsp;&nbsp;<br>&nbsp;&nbsp;usbacc.h&nbsp;&nbsp;<br>&nbsp;&nbsp;usbmic.h&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;stub file&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;usb_stub.a&nbsp;&nbsp;<br>&nbsp;&nbsp;usbacc_stub.a or usbacc_stub_weak.a&nbsp;&nbsp;<br>&nbsp;&nbsp;usbmic_stub.a or usbmic_stub_weak.a&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<br>

<!-- sce_hd4 -->
<a name="Heading4_1_5">
<h3>
<a href="#Heading3_1"> 1. </a>5 
<!-- hp1 --><b>Sample Programs</b><br>
</a>
</h3>
<div style="margin-left:50px;">The following USB mic library sample programs are available for your reference.<br></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_1_5_1"><h4>
(1)&nbsp;<b>devkit/sample/sound/audiorec</b><br></h4>
</a></div>

<!-- sce_hd5 -->
<div style="margin-left:40px;"><a name="Heading5_1_5_2"><h4>
(2)&nbsp;<b>devkit/sample/sound/rec_play</b><br></h4>
</a></div>
<div style="margin-left:67px;"><br></div>

<!-- sce_hd3 -->
<a name="Heading3_2">
<h2>
 2 <!-- hp --><b>Usage Overview</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_2_1">
<h3>
<a href="#Heading3_2"> 2. </a>1 
<!-- hp1 --><b>Load USB Drivers</b><br>
</a>
</h3>
<div style="margin-left:50px;">The USB module utility is used to load the USB accessory base driver and the USB mic driver. Refer to the sample programs for more information on how to load these modules.<br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_2">
<h3>
<a href="#Heading3_2"> 2. </a>2 
<!-- hp1 --><b>Initialize USB Drivers</b><br>
</a>
</h3>
<div style="margin-left:50px;">Execute <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStart">sceUsbStart</a>() in the following order to start each USB driver.<br></div>
<div style="margin-left:67px;"><br></div>
        <div style="margin-left:80px;"><pre><font size=3>// Start USB bus driver
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStart">sceUsbStart</a>(SCE_USB_BUS_DRIVER_NAME, 0, NULL) &lt; 0) {
	// Error handling
}

// Start USB accessory base driver
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStart">sceUsbStart</a>(<a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USBACC_NAME">SCE_USBACC_NAME</a>, 0, NULL) &lt; 0) {
	// Error handling
}

// Start USB mic driver
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStart">sceUsbStart</a>(<a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USBMIC_NAME">SCE_USBMIC_NAME</a>, 0, NULL) &lt; 0) {
	// Error handling
}
</font></pre></div>

<!-- sce_hd4 -->
<a name="Heading4_2_3">
<h3>
<a href="#Heading3_2"> 2. </a>3 
<!-- hp1 --><b>Activate USB Device</b><br>
</a>
</h3>
<div style="margin-left:50px;">Call <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbActivate">sceUsbActivate</a>() to activate the USB device. The power to the USB mic will be automatically switched on. Specify <a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USB_PID_MIC">SCE_USB_PID_MIC</a> for the argument of <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbActivate">sceUsbActivate</a>().<br></div>
<div style="margin-left:67px;"><br></div>
        <div style="margin-left:80px;"><pre><font size=3>// Activate USB device
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbActivate">sceUsbActivate</a>(<a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USB_PID_MIC">SCE_USB_PID_MIC</a>) &lt; 0) {
	// Error handling
}
</font></pre></div>
<div style="margin-left:50px;"><br>Until the USB device is activated, only <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicInputInit">sceUsbMicInputInit</a>() and <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicInputInitEx">sceUsbMicInputInitEx</a>(), which initialize mic input and set codec parameters, can be used. The codec setting parameters are maintained until the USB mic driver is stopped.<br><br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_4">
<h3>
<a href="#Heading3_2"> 2. </a>4 
<!-- hp1 --><b>Control Mic Input</b><br>
</a>
</h3>
<div style="margin-left:50px;">The correspondence between USB mic input and audio input interfaces are shown in the following table. After the USB device is activated, the USB mic input interface can be used in the same way as the audio input interface.<br><br></div>
<div style="margin-left:90px;">
<table border=1>
<tr>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>USB Mic Input</b>&nbsp;&nbsp;</td>
<td valign="TOP" bgcolor="#cccccc">&nbsp;&nbsp;<b>Audio Input</b>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicInputInit">sceUsbMicInputInit</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioInputInit">sceAudioInputInit</a>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicInputInitEx">sceUsbMicInputInitEx</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioInputInitEx">sceAudioInputInitEx</a>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicInputBlocking">sceUsbMicInputBlocking</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioInputBlocking">sceAudioInputBlocking</a>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicInput">sceUsbMicInput</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioInput">sceAudioInput</a>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicGetInputLength">sceUsbMicGetInputLength</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioGetInputLength">sceAudioGetInputLength</a>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicWaitInputEnd">sceUsbMicWaitInputEnd</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioWaitInputEnd">sceAudioWaitInputEnd</a>&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="TOP">&nbsp;&nbsp;<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbMicPollInputEnd">sceUsbMicPollInputEnd</a>&nbsp;&nbsp;</td>
<td valign="TOP">&nbsp;&nbsp;<a href="../sound/AudioInput-Reference-English.htm#sceAudioPollInputEnd">sceAudioPollInputEnd</a>&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<br>
<br>
<div style="margin-left:50px;">For an explanation of ALC, refer to the &quot;AudioInput-Overview&quot;.<br><br></div>

<!-- sce_hd4 -->
<a name="Heading4_2_5">
<h3>
<a href="#Heading3_2"> 2. </a>5 
<!-- hp1 --><b>Deactivate USB Device</b><br>
</a>
</h3>
<div style="margin-left:50px;">Call <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbDeactivate">sceUsbDeactivate</a>() to deactivate the USB device. The power to the USB mic will be automatically cut. If you are not planning to use the mic input for a while, you can reduce power consumption by deactivating the USB device in advance.<br></div>
<div style="margin-left:67px;"><br></div>
        <div style="margin-left:80px;"><pre><font size=3>// Deactivate USB device
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbDeactivate">sceUsbDeactivate</a>() &lt; 0) {
	// Error handling
}
</font></pre></div>

<!-- sce_hd4 -->
<a name="Heading4_2_6">
<h3>
<a href="#Heading3_2"> 2. </a>6 
<!-- hp1 --><b>Stop USB Drivers</b><br>
</a>
</h3>
<div style="margin-left:50px;">Execute <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStop">sceUsbStop</a>() in the following order to stop each USB driver.<br></div>
<div style="margin-left:67px;"><br></div>
        <div style="margin-left:80px;"><pre><font size=3>// Stop USB mic driver
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStop">sceUsbStop</a>(<a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USBMIC_NAME">SCE_USBMIC_NAME</a>, 0, NULL) &lt; 0) {
	// Error handling
}

// Stop USB accessory base driver
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStop">sceUsbStop</a>(<a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USBACC_NAME">SCE_USBACC_NAME</a>, 0, NULL) &lt; 0) {
	// Error handling
}

// Stop USB bus driver
if (<a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbStop">sceUsbStop</a>(SCE_USB_BUS_DRIVER_NAME, 0, NULL) &lt; 0) {
	// Error handling
}
</font></pre></div>

<!-- sce_hd4 -->
<a name="Heading4_2_7">
<h3>
<a href="#Heading3_2"> 2. </a>7 
<!-- hp1 --><b>Unload USB Drivers</b><br>
</a>
</h3>
<div style="margin-left:50px;">The USB module utility is also used to unload the drivers. For details, refer to the sample program.<br><br></div>

<!-- sce_hd3 -->
<a name="Heading3_3">
<h2>
 3 <!-- hp --><b>Description of Operation</b>
<hr noshade>
</h2>


<!-- sce_hd4 -->
<a name="Heading4_3_1">
<h3>
<a href="#Heading3_3"> 3. </a>1 
<!-- hp1 --><b>Comparison With Audio Input Interface</b><br>
</a>
</h3>
<div style="margin-left:50px;">Although the interface for controlling mic input basically has the same specifications as the audio input interface, the behavior is different if the mic has not been inserted.<br><br>Audio input and USB mic input have the following differences.<br><br>For audio input:<br></div>
<div style="margin-left:40px;"><ul>
<li> Mic insertion/removal cannot be detected
<li> Silent PCM data can be captured even when the mic has not been inserted
</ul></div>
<div style="margin-left:50px;"><br>For USB mic input:<br></div>
<div style="margin-left:40px;"><ul>
<li> USB mic insertion/removal can be detected
<li> PCM data cannot be captured if the USB mic is not connected
</ul></div>
<div style="margin-left:50px;"><br>With audio input, silent PCM data is captured even when the mic is not inserted, but for USB mic input, the <a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USBMIC_ERROR_NOT_AVAILABLE">SCE_USBMIC_ERROR_NOT_AVAILABLE</a> error is returned if the USB mic is not connected.<br><br>When a USB mic is used, be sure to take some action like displaying a dialog prompting the user to connect a USB mic if the <a href="../peripheral/USB_Mic-Reference-English.htm#SCE_USBMIC_ERROR_NOT_AVAILABLE">SCE_USBMIC_ERROR_NOT_AVAILABLE</a> error occurs.<br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_2">
<h3>
<a href="#Heading3_3"> 3. </a>2 
<!-- hp1 --><b>Connecting to a USB Accessory Not Supported by the USB Mic Library </b><br>
</a>
</h3>
<div style="margin-left:50px;">If the system is connected to a USB accessory that is not supported by the USB mic library, the USB accessory will not be recognized, and the system will be in the same state as if no USB accessory were connected at all. <br></div>

<!-- sce_hd4 -->
<a name="Heading4_3_3">
<h3>
<a href="#Heading3_3"> 3. </a>3 
<!-- hp1 --><b>Connection With a USB Host Other Than a USB Accessory</b><br>
</a>
</h3>
<div style="margin-left:50px;">When the USB mic library is used, the PSP&trade; is viewed from the USB host as a composite device with an audio class USB speaker and two vendor-unique drivers. Therefore, when a device that supports the audio class is connected, it is recognized as a USB speaker, and sound that is played on the host can be captured with the mic input on the PSP&trade;.<br><br>Whether the PSP&trade; is connected to an exclusive USB accessory for the PSP&trade; or to some other USB host can be determined by using the <a href="../peripheral/USB_Mic-Reference-English.htm#sceUsbAccGetAuthStat">sceUsbAccGetAuthStat</a>() function.<br><br></div>
<p><p><hr>
<div ALIGN="right">
    &copy;2007 Sony Computer Entertainment Inc.  All Rights Reserved.<br>
    SCE CONFIDENTIAL
</div>
</body>
</html>
